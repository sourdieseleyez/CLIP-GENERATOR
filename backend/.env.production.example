# Production Environment Variables
# UPDATED January 2025 - Production-ready configuration
#
# For Fly.io: Set as secrets with `fly secrets set KEY=value`
# For Docker: Pass via docker-compose or -e flags
# For other platforms: Set in your hosting provider's dashboard

# ============================================================================
# REQUIRED SETTINGS
# ============================================================================

# Gemini API Key (get from https://aistudio.google.com/apikey)
# NOTE: google-generativeai is LEGACY - we now use google-genai SDK
# Model: gemini-flash-lite-latest (cheapest, auto-updates)
GEMINI_API_KEY=your-gemini-api-key-here

# Additional API keys for rotation (optional but recommended for production)
# The key manager automatically rotates when rate limited (429 errors)
# GEMINI_API_KEY_2=your-second-key
# GEMINI_API_KEY_3=your-third-key
# GEMINI_API_KEY_4=your-fourth-key
# GEMINI_API_KEY_5=your-fifth-key

# JWT Secret Key - MUST be unique and random for production
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=your-random-secret-key-32-chars-or-more

# ============================================================================
# ENVIRONMENT
# ============================================================================
ENVIRONMENT=production
PORT=8080

# ============================================================================
# SECURITY (CRITICAL FOR PRODUCTION)
# ============================================================================

# NEVER set to true in production!
DISABLE_AUTH=false

# Require Gemini API for video processing
REQUIRE_GEMINI=true

# CORS - set to false and configure specific origins for production
CORS_ALLOW_ALL=false

# JWT Token Expiration
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================================================
# VIDEO PROCESSING
# ============================================================================

# Speech-to-text engine: 'whisper' (default) or 'faster-whisper'
STT_ENGINE=whisper

# Job timeout in seconds (default 1 hour)
JOB_TIMEOUT=3600

# ============================================================================
# DATABASE (PostgreSQL - REQUIRED for production)
# ============================================================================

# Neon, Railway, Supabase, or any PostgreSQL provider
DATABASE_URL=postgresql://user:password@host:5432/dbname

# Connection pool settings (tune based on your plan limits)
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800

# Enable SQL query logging (set to true for debugging only)
DB_ECHO=false

# ============================================================================
# CLOUD STORAGE (S3-compatible - REQUIRED for production)
# ============================================================================

# AWS S3, Cloudflare R2 (recommended - free egress), DigitalOcean Spaces
STORAGE_BUCKET=your-bucket-name
STORAGE_ACCESS_KEY=your-access-key
STORAGE_SECRET_KEY=your-secret-key

# For Cloudflare R2:
# STORAGE_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
# STORAGE_REGION=auto

# For DigitalOcean Spaces:
# STORAGE_ENDPOINT=https://nyc3.digitaloceanspaces.com
# STORAGE_REGION=nyc3

# For AWS S3 (no endpoint needed):
# STORAGE_REGION=us-east-1

# ============================================================================
# BACKGROUND QUEUE (Redis + RQ - RECOMMENDED for production)
# ============================================================================

# Enable Redis queue for background job processing
USE_QUEUE=true
REDIS_URL=redis://localhost:6379/0

# For Upstash Redis (serverless):
# REDIS_URL=rediss://default:your-password@your-endpoint.upstash.io:6379

# ============================================================================
# YOUTUBE INTEGRATION (Optional)
# ============================================================================

# Get credentials from Google Cloud Console
# Enable YouTube Data API v3
YOUTUBE_CLIENT_ID=your-client-id
YOUTUBE_CLIENT_SECRET=your-client-secret
YOUTUBE_REDIRECT_URI=https://your-app.fly.dev/youtube/callback

# ============================================================================
# DEPLOYMENT COMMANDS
# ============================================================================

# Fly.io:
#   fly secrets set GEMINI_API_KEY="your-key"
#   fly secrets set SECRET_KEY="$(python -c 'import secrets; print(secrets.token_urlsafe(32))')"
#   fly secrets set DATABASE_URL="postgresql://..."
#   fly secrets set STORAGE_BUCKET="..." STORAGE_ACCESS_KEY="..." STORAGE_SECRET_KEY="..."
#   fly deploy

# Docker:
#   docker run -e GEMINI_API_KEY=... -e SECRET_KEY=... your-image

# ============================================================================
# 2025 NOTES
# ============================================================================
#
# 1. google-generativeai package reached EOL November 30, 2025
#    We now use google-genai SDK (GA May 2025)
#
# 2. yt-dlp 2025.11+ requires Deno runtime for YouTube downloads
#    Install Deno: https://deno.land/manual/getting_started/installation
#
# 3. boto3 dropped Python 3.8 support April 2025 - use Python 3.9+
#
# 4. passlib + bcrypt 4.1+ has 72-byte limit issues
#    We pin bcrypt<4.1.0 in requirements.txt
#
# 5. SQLAlchemy 2.0.41 is latest stable (May 2025)
#    Uses new declarative_base from sqlalchemy.orm
